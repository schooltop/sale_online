var vjs_optionDetop={"ALERTMESSAGE":true,"ALERTCSS":true,"VJS_ACTIVE":true,"VJS_ENTERFILTER":true,"VJS_CHECKHIDDEN":true,"REG_INTEGER":/^(\+|\-|\d*)\d+$/,"REG_FLOAT":/^(\-|\+)?\d+(\.\d+)?$/,"REG_ALPHA":/^[a-zA-Z]+$/,"REG_NUM":/^[0-9]+$/,"REG_ALPHA_NUM":/^[a-zA-Z0-9]+$/,"REG_MAIL":/^\w+((-|\.)\w+)*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]{2,4}$/,"REG_MOBILE":/^(086|86){0,1}0{0,1}1[0-9]{10}$/,"FILTER_INTEGER":"[0-9\\-\\+]","FILTER_FLOAT":"[0-9\\.\\-\\+]","FILTER_ALPHA":"[a-zA-Z]","FILTER_NUM":"[0-9]","FILTER_ALPHA_NUM":"[a-zA-Z0-9]"};var vjs_support_property=new Array(new Array("required",1,"vjs_required","text,password,textarea,radio,checkbox,file","不能为空！"),new Array("existed",1,"vjs_existed","select","不存在的值!"),new Array("integer",1,"vjs_integer","text,password,textarea","必须是整数！"),new Array("float",1,"vjs_float","text,password,textarea","必须是浮点数！"),new Array("alpha",1,"vjs_alpha","text,password,textarea","必须是字母！"),new Array("numeric",1,"vjs_num","text,password,textarea","必须是数字！"),new Array("alpha_num",1,"vjs_alphanum","text,password,textarea","必须是数字！"),new Array("reg_exp",2,"vjs_reg_exp","text,password,textarea","格式不对！"),new Array("filter",2,"vjs_filter","text,password,textarea",""),new Array("mobile",1,"vjs_mobile","text","不是手机号码！"),new Array("mail",1,"vjs_mail","text","不是邮件格式！"));Array.prototype.getSolidDyProperty=vjs_getSolidDyProperty;Array.prototype.getSolidDyIndex=vjs_getSolidDyIndex;String.prototype.filtering=vjs_filtering;function vjs_filtering(filter){var result="";var re=new RegExp(filter);for(var idx=0;idx<this.length;idx++)result+=re.test(this.charAt(idx))?this.charAt(idx):"";delete re;return result;};function vjs_getSolidDyIndex(key){for(var propertyIndex=0;propertyIndex<vjs_support_property.length;propertyIndex++){if(vjs_support_property[propertyIndex][0]==key){return propertyIndex;};};};function vjs_getSolidDyProperty(key){return vjs_support_property[this.getSolidDyIndex(key)];};function vjs_mobile(parent){this.parent=parent;this.vjs_key="mobile";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_mobile_validate;this.getMessage=vjs_get_message;};function _mobile_validate(evnt){var flag=true;var reg=window.GetOption("REG_MOBILE");if(!this.parent.value){flag=true;}else{flag=reg.test(this.parent.value);};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_mail(parent){this.parent=parent;this.vjs_key="mail";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_mail_validate;this.getMessage=vjs_get_message;};function _mail_validate(evnt){var flag=true;var reg=window.GetOption("REG_MAIL");if(!this.parent.value){flag=true;}else{flag=reg.test(this.parent.value);};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_filter(parent){this.parent=parent;this.vjs_key="filter";};function vjs_filter_onkeypress(oInput,oEvent){if(!window.GetOption("VJS_ENTERFILTER"))return;var sKey=String.fromCharCode(oEvent.keyCode);var re=new RegExp(oInput.getAttribute("filter"));if(sKey!="\r"&&!re.test(sKey))oEvent.returnValue=false;delete re;};function vjs_reg_exp(parent){this.parent=parent;this.vjs_key="reg_exp";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_reg_exp_validate;this.getMessage=vjs_get_message;};function _reg_exp_validate(evnt){var flag=true;var reg=new RegExp(this.parent.getAttribute("reg_exp"));if(!this.parent.value){flag=true;}else{flag=reg.test(this.parent.value);};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_alphanum(parent){this.parent=parent;this.vjs_key="alpha_num";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_alphanum_validate;this.getMessage=vjs_get_message;};function _alphanum_validate(evnt){var flag=true;var RegExp=window.GetOption("REG_ALPHA_NUM");if(!this.parent.value){flag=true;}else{flag=RegExp.test(this.parent.value);};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_alphanum_onkeypress(oInput,oEvent){if(!window.GetOption("VJS_ENTERFILTER"))return;var sKey=String.fromCharCode(oEvent.keyCode);var re=new RegExp(window.GetOption("FILTER_ALPHA_NUM"));if(sKey!="\r"&&!re.test(sKey))oEvent.returnValue=false;delete re;};function vjs_alphanum_onpaste(oInput,oEvent){try{var val=window.clipboardData.getData("Text");window.clipboardData.setData("Text",val.filtering(window.GetOption("FILTER_ALPHA_NUM")));}catch(e){};};function vjs_num(parent){this.parent=parent;this.vjs_key="numeric";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_num_validate;this.getMessage=vjs_get_message;};function _num_validate(evnt){var flag=true;var RegExp=window.GetOption("REG_NUM");if(!this.parent.value){flag=true;}else{flag=RegExp.test(this.parent.value);};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_num_onkeypress(oInput,oEvent){if(!window.GetOption("VJS_ENTERFILTER"))return;var sKey=String.fromCharCode(oEvent.keyCode);var re=new RegExp(window.GetOption("FILTER_NUM"));if(sKey!="\r"&&!re.test(sKey))oEvent.returnValue=false;delete re;};function vjs_num_onpaste(oInput,oEvent){try{var val=window.clipboardData.getData("Text");window.clipboardData.setData("Text",val.filtering(window.GetOption("FILTER_NUM")));}catch(e){};};function vjs_alpha(parent){this.parent=parent;this.vjs_key="alpha";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_alpha_validate;this.getMessage=vjs_get_message;};function _alpha_validate(evnt){var flag=true;var RegExp=window.GetOption("REG_ALPHA");if(!this.parent.value){flag=true;}else{flag=RegExp.test(this.parent.value);};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_alpha_onkeypress(oInput,oEvent){if(!window.GetOption("VJS_ENTERFILTER"))return;var sKey=String.fromCharCode(oEvent.keyCode);var re=new RegExp(window.GetOption("FILTER_ALPHA"));if(sKey!="\r"&&!re.test(sKey))oEvent.returnValue=false;delete re;};function vjs_alpha_onpaste(oInput,oEvent){try{var val=window.clipboardData.getData("Text");window.clipboardData.setData("Text",val.filtering(window.GetOption("FILTER_ALPHA")));}catch(e){};};function vjs_float(parent){this.parent=parent;this.vjs_key="float";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_float_validate;this.getMessage=vjs_get_message;};function _float_validate(evnt){var flag=true;var RegExp=window.GetOption("REG_FLOAT");if(!this.parent.value){flag=true;}else{flag=RegExp.test(this.parent.value);};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_float_onkeypress(oInput,oEvent){if(!window.GetOption("VJS_ENTERFILTER"))return;var sKey=String.fromCharCode(oEvent.keyCode);var re=new RegExp(window.GetOption("FILTER_FLOAT"));if(sKey!="\r"&&!re.test(sKey))oEvent.returnValue=false;delete re;};function vjs_float_onpaste(oInput,oEvent){try{var val=window.clipboardData.getData("Text");window.clipboardData.setData("Text",val.filtering(window.GetOption("FILTER_FLOAT")));}catch(e){};};function vjs_integer(parent){this.parent=parent;this.vjs_key="integer";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_integer_validate;this.getMessage=vjs_get_message;};function _integer_validate(evnt){var flag=true;var RegExp=window.GetOption("REG_INTEGER");if(!this.parent.value){flag=true;}else{flag=RegExp.test(this.parent.value);};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_integer_onkeypress(oInput,oEvent){if(!window.GetOption("VJS_ENTERFILTER"))return;var sKey=String.fromCharCode(oEvent.keyCode);var re=new RegExp(window.GetOption("FILTER_INTEGER"));if(sKey!="\r"&&!re.test(sKey))oEvent.returnValue=false;delete re;};function vjs_integer_onpaste(oInput,oEvent){try{var val=window.clipboardData.getData("Text");window.clipboardData.setData("Text",val.filtering(window.GetOption("FILTER_INTEGER")));}catch(e){};};function vjs_existed(parent){this.parent=parent;this.vjs_key="existed";this.vjs_css="";this.parent.setCss(this.vjs_css);this.validate=_existed_validate;this.getMessage=vjs_get_message;};function _existed_validate(evnt){var flag=true;if(!this.parent.tagName)flag=false;if(!this.parent.value)flag=false;if(flag&&this.parent.tagName=='SELECT'){var isNotValue=false;var selectValue=this.parent.value;for(var index=0;index<this.parent.options.length;index++){if(selectValue==this.parent.options[index].value){isNotValue=true;break;};};if(!isNotValue){flag=false;};};if(!flag){this.parent.alert(this.getMessage());};return flag;};function vjs_required(parent){this.parent=parent;this.vjs_key="required";this.vjs_css="vjs_css_required";this.parent.setCss(this.vjs_css);this.validate=_required_validate;this.getMessage=vjs_get_message;};function _required_validate(evnt){var flag=true;if(!this.parent.value)flag=false;if(flag&&/^\s*$/.test(this.parent.value)){flag=false;};if(flag&&this.parent.type=="checkbox"&&!this.parent.checked)flag=false;if(flag&&this.parent.type=="radio"&&!this.parent.checked)flag=false;if(!flag){this.parent.alert(this.getMessage());};return flag;};Array.prototype.getIndex=vjs_array_index;Array.prototype.include=vjs_array_include;Array.prototype.subtract=vjs_array_subtract;String.prototype.filter=vjs_filtering;function vjs_filtering(filter){var result="";var re=new RegExp(filter);for(var idx=0;idx<this.length;idx++)result+=re.test(this.charAt(idx))?this.charAt(idx):"";delete re;return result;};function vjs_array_include(key){for(var keyIndex=0;keyIndex<this.length;keyIndex++){if(this[keyIndex].toLowerCase()==key.toLowerCase())return true;};return false;};function vjs_array_index(key){if(!(this[0]instanceof Array))return false;for(var arrayIndex=0;arrayIndex<this.length;arrayIndex++){if(this[arrayIndex][0]==key)return arrayIndex;};return false;};function vjs_array_subtract(key){var subArray=new Array;for(var aIndex=0;aIndex<this.length;aIndex++){if(key==this[aIndex])continue;subArray[subArray.length]=this[aIndex];};return subArray;};function vjs_onsubmit(){var flag=true;var lform=(window.event&&window.event.type=='submit'&&window.event.returnValue!=false)?window.event.srcElement:null;if(lform&&lform.serverSubmit(window.event)==false){window.event.returnValue=false;flag=false;};if(flag&&lform.userOnSubmitHandler&&lform.userOnSubmitHandler()==false){window.event.returnValue=false;flag=false;};return flag;};function vjs_handle_submit(evnt){if(this.serverSubmit())this.submit();else return false;};function vjs_server_submit(evnt){var flag=true;var srcObj=(evnt&&evnt.type=='submit')?evnt.srcElement:this;if(srcObj.validate){flag=srcObj.validate(evnt);};return flag;};function vjs_get_message(){var elementDesc="";if(typeof(this.parent.desc)!='undefined'){elementDesc=this.parent.desc;};var keyIndex=vjs_support_property.getIndex(this.vjs_key);return elementDesc+vjs_support_property[keyIndex][4];};function vjs_validate(actionflag,evnt){if(actionflag==false){window.SetOption("VJS_CHECKHIDDEN",false);};for(var eIndex=0;eIndex<this.elements.length;eIndex++){if(this.elements[eIndex].tagName=="OBJECT")continue;if(this.elements[eIndex].validate&&this.elements[eIndex].validate(actionflag,evnt)==false){return false;};};window.SetOption("VJS_CHECKHIDDEN",true);return true;};function element_event_handler(){var srcEvent=window.event;var srcObj=window.event.srcElement;var type=window.event.type;if(!srcObj.dyProperties)return;for(var pIndex=0;pIndex<srcObj.dyProperties.length;pIndex++){ecmd="window.vjs_"+srcObj.dyProperties[pIndex].vjs_key+"_on"+type;try{if(eval(ecmd)&&eval(ecmd+"(srcObj, srcEvent)")==false){window.event.returnValue=false;return false;};}catch(e){};};if(type=='focus'&&(srcObj.type=="text"||srcObj.type=="password"||srcObj.type=="textarea"||srcObj.type=="file")&&srcObj.select){srcObj.select();};};function element_unSetCss(cssClass){var css=this.getAttribute("className");if(!css)return;var cssArray=css.split(" ");if(cssArray.include(cssClass)){this.setAttribute("className",cssArray.subtract(cssClass).join(" "));};};function element_setCss(cssClass){var css=this.getAttribute("className");if(!css){this.setAttribute("className",cssClass);return;};if(!css.split(" ").include(cssClass)){this.setAttribute("className",css+" "+cssClass);};};function element_isAttribute(key){return(this.getAttribute(key)!=null)?true:false;};function element_hasAttributeValue(key){return(this.getAttribute(key))?true:false;};function element_setDyProperty(key,deal,param){var flag=true;var index=vjs_support_property.getIndex(key);if(vjs_support_property[index][1]==0)return false;var supportTypes=vjs_support_property[index][3].split(",");if(!supportTypes.include(this.type)&&!supportTypes.include(this.tagName))return false;for(var pIndex=0;pIndex<this.dyProperties.length;pIndex++){if(this.dyProperties[pIndex].vjs_key==key)flag=false;};var dyProperty=eval("new "+deal+"(this, param)");this.dyProperties[this.dyProperties.length]=dyProperty;if(dyProperty.initialize)dyProperty.initialize();return flag;};function dyProperty_factory(){for(var dyProperty=0;dyProperty<vjs_support_property.length;dyProperty++){if(this.isAttribute(vjs_support_property[dyProperty][0])){if((vjs_support_property[dyProperty][1]==2)&&!this.hasAttributeValue(vjs_support_property[dyProperty][0]))continue;this.setDyProperty(vjs_support_property[dyProperty][0],vjs_support_property[dyProperty][2]);};};};function element_validate(actionflag,evnt){if(!element_checkVisibility(this)&&!window.GetOption("VJS_CHECKHIDDEN")){return true;};var flag=true;if(!this.dyProperties||!this.dyProperties.length)return true;for(var dyIndex=0;flag&&dyIndex<this.dyProperties.length;dyIndex++){if(this.dyProperties[dyIndex].validate&&this.dyProperties[dyIndex].validate(actionflag,evnt)==false){flag=false;break;};};if(flag){this.unSetCss("vjs_css_error");}else{if(window.GetOption("ALERTCSS")){if(element_checkVisibility(this)){this.setCss("vjs_css_error");this.focus();}else{window.alert("存在非法的页面无法看到的对象.");};};};return flag;};function element_alert(message){if(window.GetOption("ALERTMESSAGE")){window.alert(message);};};function element_attach(key,val){var config=vjs_support_property.getSolidDyProperty(key);if(!config)return false;val=(typeof(val)=="undefined")?this.getAttribute(key):val;try{if(!config[0]||(config[0]==1&&val))return false;if(config[0]==2&&!val)return false;if(!config[2].split(",").contain(this.type))return false;if(this.eBuffer.contain(key))return false;this.eBuffer[this.eBuffer.length]=config[1];this.setAttribute(key,typeof(val)=="undefined"?"":val);var eFunction="window."+config[1]+"_attach";try{if(eval(eFunction)){eval(cbFunc+"(this)");};}catch(e){};}catch(e){return false;};return true;};function element_detach(key){if(!this.eBuffer.length)return false;var config=vjs_support_property.getSolidDyProperty(key);if(!config)return false;var flag=false;var nBuffer=new Array;for(var eIndex=0;eIndex<this.eBuffer.length;eIndex++){if(this.eBuffer[eIndex]==config[1])flag=true;else nBuffer[nBuffer.length]=this.xBuffer[eIndex];};if(flag){var eFunction="window."+config[1]+"_detach";try{if(eval(eFunction))eval(eFunction+"(this)");}catch(e){};this.removeAttribute(key);this.unsetBgColor("xjs_error");this.eBuffer=nBuffer;};return true;};function element_checkVisibility(obj){if(obj&&obj.type=='hidden'){return false;}else{if(!element_isVisible(obj))return false;};var pr=obj.parentNode;do{if(pr==undefined||pr=="undefined")return true;else{if(!element_isVisible(pr))return false;};}while(pr=pr.parentNode);return true;};function element_isVisible(obj){var visAtt,disAtt;try{disAtt=obj.style.display;visAtt=obj.style.visibility;}catch(e){};if(disAtt=="none"||visAtt=="hidden")return false;return true;};function element_initialize(parent){this.parent=parent;this.dyProperties=new Array;this.isAttribute=element_isAttribute;this.hasAttributeValue=element_hasAttributeValue;this.setDyProperty=element_setDyProperty;this.factory=dyProperty_factory;this.setCss=element_setCss;this.unSetCss=element_unSetCss;this.validate=element_validate;this.alert=element_alert;this.eventHandler=element_event_handler;this.detachEvent("onkeypress",this.eventHandler);this.detachEvent("onkeyup",this.eventHandler);this.detachEvent("onkeydown",this.eventHandler);this.detachEvent("onfocus",this.eventHandler);this.detachEvent("onblur",this.eventHandler);this.detachEvent("onchange",this.eventHandler);this.detachEvent("onclick",this.eventHandler);this.detachEvent("onmouseover",this.eventHandler);this.detachEvent("onmouseout",this.eventHandler);this.detachEvent("onpaste",this.eventHandler);this.attachEvent("onkeypress",this.eventHandler);this.attachEvent("onkeyup",this.eventHandler);this.attachEvent("onkeydown",this.eventHandler);this.attachEvent("onfocus",this.eventHandler);this.attachEvent("onblur",this.eventHandler);this.attachEvent("onchange",this.eventHandler);this.attachEvent("onclick",this.eventHandler);this.attachEvent("onmouseover",this.eventHandler);this.attachEvent("onmouseout",this.eventHandler);this.attachEvent("onpaste",this.eventHandler);this.factory();};function vjs_initialize(){for(var elementNum=0;elementNum<this.elements.length;elementNum++){if(this.elements[elementNum].tagName=="OBJECT")continue;if(this.elements[elementNum].type=='hidden')continue;this.elements[elementNum].initialize=element_initialize;this.elements[elementNum].initialize(this);};};function vjs(){this.initialize=vjs_initialize;this.serverSubmit=vjs_server_submit;this.handleSubmit=vjs_handle_submit;this.validate=vjs_validate;this.refresh=vjs_initialize;if(this.onsubmit)this.userOnSubmitHandler=this.onsubmit;this.onsubmit=vjs_onsubmit;this.initialize();};function vjs_get_option(key){return vjs_optionDetop[key];};function vjs_set_option(key,value){return vjs_optionDetop[key]=value;};function vjs_protal(){if(!vjs_optionDetop["VJS_ACTIVE"]){return false;};this.GetOption=vjs_get_option;this.SetOption=vjs_set_option;for(var formNum=0;formNum<document.forms.length;formNum++){document.forms[formNum].initialize=vjs;document.forms[formNum].initialize();};};vjs_protal();
